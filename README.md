# Personio-timelogger

This tool lets you automatically log working time to your personio Attendance table and getting a feedback by Slack when the entry to the Attendance table has been successfully posted.
It consists in two parts, the client and the server.
## The client
Written in Python3. It does a login into the Personio site and post the autogenerated working time values.
#### Requirements
- Python3
#### Configuration
A `config.py` file needs to be created out from `config_sample.py` file with your own credentials and configuration.
Example configuration:
```
#Personio credentials
EMAIL = 'name.surname@rindus.de'
PASSWORD = 'myStrong!Password'
PROFILE_ID = '0000000' # This can be found in your personio profile URL

#Slack credentials
SLACK_SECRET = 'aaaaaaa'

#App configuration
STARTING_HOUR = 7 # Hour you usually start working in the morning
WORKING_HOURS = 9 # Including break time
```

The generated time will always be less than the `WORKING_HOURS` in order not to exceed the maximum allowed by the law as it will be treated as overtime work

#### Usage
    $ python3 personio-timelogger.py 2019-06-07
#### Recomendation
A cron job can be created to run this automatically every working day (from Monday to Friday).
For example, the following cron entry will be triggered at 17:00 every working day

    0 17 * * 1-5 python3 personio-timelogger.py $(date +%Y-%m-%d) >/dev/null 2>&1

##### Next Steps
- Improve the times of the week 

## The Server
Written in Javascript. It is a bot for slack which will handle the feedback from the client and will inform the user which information has been posted to personio when the client runs.

#### Requirements
- NodeJS
- npm (or yarn)
#### Configuration
1. Run
`$ npm i`
2. Create .env file with the following content

```
// Server Config
PORT=3000
// Found under Basic Information in Slack
SLACK_CLIENT_ID=
SLACK_CLIENT_SECRET=
SLACK_VERIFICATION_TOKEN=
// Found under OAuth & Permissions in Slack (the bot token)
SLACK_AUTH_TOKEN=xoxb-...
```
3. Run the server
`$ node server.js`

### The Slack Bot
The bot will personally send you feedback when a new post to personio has been successfully done.
You need to register into the bot to be able to receive incoming messages from it.
Follow the following instructions:
1. Open Rindus Slack
2. Go to `slackbot` conversation below _Direct messages_
3. Run
`/timelogger`
4. You will receive a secret key from the bot. This secret key is the one you have to store in the client `config.py` file as `SLACK_SECRET`